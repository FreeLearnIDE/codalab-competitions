{% extends 'base.html' %}
{% load staticfiles %}
{% load codalab_tags %}
{% load tz %}
{% load url from future %}

{% block page_title %}Submissions{% endblock page_title %}
{% block head_title %}Submissions{% endblock %}

{% block extra_headers %}
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">

    <style>
        /*#app table {
            background-color: #fff;
            border: 1px solid #ccc;
            border-bottom-color: transparent;
        }*/

        #app table tbody {
            background-color: #f7f7f7;
        }

        /*#app .v-data-footer {
            background-color: #fff;
            border: 1px solid #ccc;
        }*/
    </style>
{% endblock %}

{% block content %}
    Add phase selector<br/>
    Display phase max submissions and such<br/>
    {% verbatim %}
        <div id="app">
            <v-app>
                <v-card outlined>
                    <v-card-title>
                        Phase drop down selector here, defaults to all phases
                        <v-spacer></v-spacer>
                        <v-text-field
                                v-model="search"
                                append-icon="mdi-magnify"
                                label="Search"
                                single-line
                                hide-details
                        ></v-text-field>
                    </v-card-title>

                    <v-data-table
                            :search="search"
                            :loading="items === undefined"
                            :headers="headers"
                            :items="items"
                    >
                        <template v-slot:item.submitted_at="{ item }">
                            <span>{{ new Date(item.submitted_at).toLocaleString() }}</span>
                        </template>

                        <template v-slot:item.leaderboard="{ item }">
                    <span v-if="item.leaderboard">
                        &#10003;
                    </span>
                        </template>
                    </v-data-table>
                </v-card>
            </v-app>
        </div>
    {% endverbatim %}
{% endblock %}

{% block extra_scripts %}
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script>
        $(document).ready(function () {
            new Vue({
                el: '#app',
                vuetify: new Vuetify(),
                data: function () {
                    return {
                        search: '',
                        headers: [
                            /*
                            #
                            SUBMITTED
                            SUBMITTED BY
                            SUBMISSION ID
                            FILENAME
                            STATUS
                            LEADERBOARD
                            RESULTS

                            Actions: Del, Show, Failed, Re-run
                             */
                            {text: 'ID', value: 'id', width: '75px'},
                            {text: 'Submitted at', value: 'submitted_at', width: '200px'},
                            {text: 'Participant', value: 'username'},
                            {text: 'Filename', value: 'filename'},
                            {text: 'Status', value: 'status'},
                            {text: 'Leaderboard', value: 'leaderboard'},
                            {text: 'Results', value: 'results'},
                            //{text: '', value: 'actions'},
                        ],
                        items: undefined,
                    }
                },
                async mounted() {
                    let resp = await $.get("/api/competition/6/submissions/")
                    this.items = resp
                }
            })
        })
    </script>
{% endblock %}
